{
  "metadata": {
    "analysis_date": "2025-06-05T14:37:18Z",
    "repository": "/Volumes/tkr-riffic/@tkr-projects/tkr-news-gather",
    "agent_version": "1.0.0",
    "analysis_depth": 3
  },
  "overall_score": {
    "security_score": 72,
    "max_score": 100,
    "grade": "B-",
    "risk_level": "MEDIUM",
    "recommendation": "REQUIRES_HARDENING"
  },
  "category_scores": {
    "authentication_authorization": {
      "score": 65,
      "max_score": 100,
      "findings": 3,
      "critical_issues": 1,
      "description": "JWT and API key auth implemented but hardcoded credentials present"
    },
    "input_validation": {
      "score": 80,
      "max_score": 100,
      "findings": 2,
      "critical_issues": 0,
      "description": "Strong validation with SSRF protection, minor bypass risks"
    },
    "data_protection": {
      "score": 55,
      "max_score": 100,
      "findings": 3,
      "critical_issues": 1,
      "description": "No encryption at rest, credentials in environment variables"
    },
    "api_security": {
      "score": 75,
      "max_score": 100,
      "findings": 3,
      "critical_issues": 0,
      "description": "Good rate limiting and headers, needs versioning"
    },
    "dependency_management": {
      "score": 70,
      "max_score": 100,
      "findings": 2,
      "critical_issues": 0,
      "description": "Recent updates but needs continuous monitoring"
    },
    "error_handling": {
      "score": 85,
      "max_score": 100,
      "findings": 2,
      "critical_issues": 0,
      "description": "Good sanitization and logging practices"
    },
    "database_security": {
      "score": 60,
      "max_score": 100,
      "findings": 2,
      "critical_issues": 0,
      "description": "RLS enabled but overly permissive policies"
    },
    "transport_security": {
      "score": 90,
      "max_score": 100,
      "findings": 1,
      "critical_issues": 0,
      "description": "Excellent security headers and HTTPS configuration"
    },
    "logging_monitoring": {
      "score": 80,
      "max_score": 100,
      "findings": 2,
      "critical_issues": 0,
      "description": "Good request logging, needs audit improvements"
    },
    "container_deployment": {
      "score": 60,
      "max_score": 100,
      "findings": 1,
      "critical_issues": 0,
      "description": "Basic security practices, needs scanning"
    }
  },
  "severity_distribution": {
    "critical": {
      "count": 2,
      "percentage": 11.1,
      "findings": ["CRITICAL-001", "CRITICAL-002"]
    },
    "high": {
      "count": 4,
      "percentage": 22.2,
      "findings": ["HIGH-001", "HIGH-002", "HIGH-003", "HIGH-004"]
    },
    "medium": {
      "count": 7,
      "percentage": 38.9,
      "findings": ["MEDIUM-001", "MEDIUM-002", "MEDIUM-003", "MEDIUM-004", "MEDIUM-005", "MEDIUM-006", "MEDIUM-007"]
    },
    "low": {
      "count": 5,
      "percentage": 27.8,
      "findings": ["LOW-001", "LOW-002", "LOW-003", "LOW-004", "LOW-005"]
    }
  },
  "risk_metrics": {
    "exploitability_score": 6.5,
    "impact_score": 7.8,
    "likelihood_score": 5.2,
    "business_risk_score": 6.8,
    "technical_debt_score": 7.2
  },
  "compliance_metrics": {
    "owasp_top_10_coverage": {
      "total_categories": 10,
      "addressed": 8,
      "partially_addressed": 2,
      "not_addressed": 0,
      "score": 80,
      "details": {
        "A01_broken_access_control": "ADDRESSED",
        "A02_cryptographic_failures": "PARTIAL",
        "A03_injection": "ADDRESSED",
        "A04_insecure_design": "ADDRESSED",
        "A05_security_misconfiguration": "ADDRESSED",
        "A06_vulnerable_components": "PARTIAL",
        "A07_authentication_failures": "ADDRESSED",
        "A08_software_integrity": "ADDRESSED",
        "A09_logging_monitoring": "ADDRESSED",
        "A10_ssrf": "ADDRESSED"
      }
    },
    "cis_controls": {
      "total_controls": 18,
      "implemented": 12,
      "partial": 4,
      "missing": 2,
      "score": 72
    },
    "nist_framework": {
      "identify": 85,
      "protect": 70,
      "detect": 75,
      "respond": 60,
      "recover": 65,
      "overall": 71
    }
  },
  "security_controls": {
    "total_recommended": 25,
    "implemented": 15,
    "partially_implemented": 6,
    "missing": 4,
    "implementation_rate": 60
  },
  "code_quality_metrics": {
    "security_focused_functions": 18,
    "functions_with_validation": 12,
    "functions_with_auth": 8,
    "security_test_coverage": 45,
    "lines_of_security_code": 847,
    "total_lines_of_code": 2156,
    "security_code_ratio": 39.3
  },
  "dependency_metrics": {
    "total_dependencies": 16,
    "security_focused_dependencies": 5,
    "dependencies_with_known_cves": 2,
    "outdated_dependencies": 1,
    "security_dependency_ratio": 31.3,
    "last_dependency_update": "2025-01-04"
  },
  "api_security_metrics": {
    "total_endpoints": 15,
    "authenticated_endpoints": 12,
    "rate_limited_endpoints": 15,
    "input_validated_endpoints": 13,
    "endpoints_with_auth_rate": 80,
    "endpoints_with_validation_rate": 86.7
  },
  "database_metrics": {
    "tables_with_rls": 4,
    "total_tables": 4,
    "rls_coverage": 100,
    "tables_with_audit": 0,
    "audit_coverage": 0,
    "encrypted_fields": 0,
    "total_sensitive_fields": 3,
    "encryption_coverage": 0
  },
  "container_metrics": {
    "base_image_vulnerabilities": "UNKNOWN",
    "last_base_image_update": "UNKNOWN",
    "security_scanning_enabled": false,
    "secrets_in_image": false,
    "running_as_root": false,
    "security_score": 60
  },
  "trends": {
    "security_score_trend": {
      "current": 72,
      "previous": null,
      "change": null,
      "trend": "INITIAL"
    },
    "vulnerability_trend": {
      "current_critical": 2,
      "previous_critical": null,
      "critical_change": null,
      "trend": "INITIAL"
    }
  },
  "benchmarks": {
    "industry_average": 65,
    "compliance_baseline": 80,
    "performance_vs_industry": "ABOVE_AVERAGE",
    "performance_vs_compliance": "BELOW_BASELINE"
  },
  "action_items": {
    "immediate_attention": [
      {
        "finding_id": "CRITICAL-001",
        "effort": "HIGH",
        "impact": "CRITICAL",
        "priority": 1
      },
      {
        "finding_id": "CRITICAL-002",
        "effort": "MEDIUM",
        "impact": "CRITICAL",
        "priority": 2
      }
    ],
    "next_sprint": [
      {
        "finding_id": "HIGH-001",
        "effort": "LOW",
        "impact": "HIGH",
        "priority": 3
      },
      {
        "finding_id": "HIGH-002",
        "effort": "MEDIUM",
        "impact": "HIGH",
        "priority": 4
      }
    ],
    "technical_debt": [
      {
        "finding_id": "MEDIUM-003",
        "effort": "HIGH",
        "impact": "MEDIUM",
        "priority": 8
      },
      {
        "finding_id": "MEDIUM-006",
        "effort": "MEDIUM",
        "impact": "MEDIUM",
        "priority": 9
      }
    ]
  },
  "recommendations": {
    "score_improvement_potential": 25,
    "estimated_effort_weeks": 8,
    "recommended_next_actions": [
      "Remove hardcoded credentials",
      "Implement secure secret management",
      "Fix database RLS policies",
      "Add container scanning"
    ],
    "priority_order": [
      "Authentication hardening",
      "Secret management",
      "Database security",
      "Continuous monitoring"
    ]
  }
}